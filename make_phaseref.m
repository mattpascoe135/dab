function [sym] = make_phaseref()

  sym = zeros(1, 2048);
  map = -1024:1024;
  for (k=-768:768)
    if (k == 0)
     IQ = 0;
    else
     PHI = getPhi(k);
     IQ = exp(j*PHI);
    end
    sym(k+1024) = IQ;
  end


function [PHI] = getPhi(k)

    htable = [[-768, -737, 0, 1]; ...
         [-736, -705, 1, 2]; ...
         [-704, -673, 2, 0]; ...
         [-672, -641, 3, 1]; ...
         [-640, -609, 0, 3]; ...
         [-608, -577, 1, 2]; ...
         [-576, -545, 2, 2]; ...
         [-544, -513, 3, 3]; ...
         [-512, -481, 0, 2]; ...
         [-480, -449, 1, 1]; ...
         [-448, -417, 2, 2]; ...
         [-416, -385, 3, 3]; ...
         [-384, -353, 0, 1]; ...
         [-352, -321, 1, 2]; ...
         [-320, -289, 2, 3]; ...
         [-288, -257, 3, 3]; ...
         [-256, -225, 0, 2]; ...
         [-224, -193, 1, 2]; ...
         [-192, -161, 2, 2]; ...
         [-160, -129, 3, 1]; ...
         [-128,  -97, 0, 1]; ...
         [-96,   -65, 1, 3]; ...
         [-64,   -33, 2, 1]; ...
         [-32,    -1, 3, 2]; ...
         [  1,    32, 0, 3]; ...
         [ 33,    64, 3, 1]; ...
         [ 65,    96, 2, 1]; ...
         [ 97,   128, 2, 1]; ...
         [ 129,  160, 0, 2]; ...
         [ 161,  192, 3, 2]; ...
         [ 193,  224, 2, 1]; ...
         [ 225,  256, 1, 0]; ...
         [ 257,  288, 0, 2]; ...
         [ 289,  320, 3, 2]; ...
         [ 321,  352, 2, 3]; ...
         [ 353,  384, 1, 3]; ...
         [ 385,  416, 0, 0]; ...
         [ 417,  448, 3, 2]; ...
         [ 449,  480, 2, 1]; ...
         [ 481,  512, 1, 3]; ...
         [ 513,  544, 0, 3]; ...
         [ 545,  576, 3, 3]; ...
         [ 577,  608, 2, 3]; ...
         [ 609,  640, 1, 0]; ...
         [ 641,  672, 0, 3]; ...
         [ 673,  704, 3, 0]; ...
         [ 705,  736, 2, 1]; ...
         [ 737,  768, 1, 1]];

    % find line in htable corresponding to k
    idx = find(htable(:,1) > k) - 1;
    if (isempty(idx))
      idx = 48; % the last row!
    end
    myrow = htable(idx(1),:);

    % note 0-15 is repeated in 16-31
    hfunc = [[0 2 0 0 0 0 1 1 2 0 0 0 2 2 1 1]; ...
             [0 3 2 3 0 1 3 0 2 1 2 3 2 3 3 0]; ...
             [0 0 0 2 0 2 1 3 2 2 0 2 2 0 1 3]; ...
             [0 1 2 1 0 3 3 2 2 3 2 1 2 1 3 2]];
    hfunc = [hfunc hfunc];

    lookupr = myrow(3) + 1;
    lookupc = k - myrow(1) + 1;
    PHI = pi/2 * (hfunc(lookupr, lookupc) + myrow(4));


